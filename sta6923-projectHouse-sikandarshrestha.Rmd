```{r}
getwd()
setwd("/Users/aavymac/UTSA/FallSemester2025/STA6923-Intro_to_Statistical_Learning/sta6923-project")
```

## 1. Extraction & Cleaning

```{r}
house<- read.csv("House Price Prediction Dataset.csv")
head(house)
```

```{r}
# structure function 
str(house)
```

```{r}
colSums(is.na(house))
```

**Missing values:** In this dataset, there is no missing values.

```{r}
# Function to convert `character` columns to `factor`, removed `Id` 
df_clean <- function(df) {
                                        # Identify character columns
                                        char_cols <- sapply(df, is.character)
                                        
                                        # Convert character columns to factors
                                        df[char_cols] <- lapply(df[char_cols], as.factor)
                                        # df$YearBuilt <- as.factor(house$YearBuilt)
                                        
                                        # Remove 'Id' column
                                        df <- df[, !names(df) %in% "Id" ]
                                        # Return updated dataframe
                                        return(df)
                                      }
```

```{r}
house <- df_clean(house)
```

```{r}
str(house)
```

## Binning on `YearBuilt` variable

```{r}
house$YearBuiltBin <- cut(
                    house$YearBuilt,
                    breaks = c(1900, 1925,1950, 1975, 2000, 2025),
                    labels = c("1900–1925", "1926–1950", "1951-1975", "1976–2000", "2001–2025"),
                    include.lowest = TRUE
                  )
```

```{r}
table(house$YearBuilt)
```

```{r}
table(house$YearBuiltBin)
```

```{r}
str(house)
```

## 2. Descriptive Statistics & Data Overview:-

```{r}
library(psych)
describe(house)
```

```{r}
summary(house)
```

## 2.1 Initial insights from Numerical data:

-   **Area:** Properties also show a large range in size (501 to 4,999 sq ft) with mean sq.ft is 2786.21.

-   **Price:** Property prices vary from \$50,005.00 to \~ \$1 million with average price is around \$537,676.85. Its SD is higher(\$276428.85), so it indicates significantly dispersion.

## 2.2 Initial insights from categorical data:

**Location=\>**

-   Downtown: 558 Rural: 474 Suburban: 483 Urban: 485

```{=html}
<!-- -->
```
-   The distribution is relatively balanced within rural, suburban, & urban. But, downtown has more properties.

**Condition=\>**

-   Excellent:511 Fair:521 Good:461 Poor:507

-   The distribution across condition grades are fairly unifrom except Good one.

**Garage=\>**

-   No:1038 Yes:962

-   There is almost an even split between properties having Garage or not.

**YearBuilt=\>**

-   The distribution is almost evenly uniform at each 25 years period from 1900 to 2025.

```{r}
# remove `YearBuilt` variabel from dataset `house`
house <- house[,-5]
```

```{r}
str(house)
```

```{r}
cols_fac <- names(house)[sapply(house, is.factor)]
cols_num <- names(house)[sapply(house, is.numeric)]
cat('categorical variables:::>',cols_fac,'\n')
cat('numeric variables:::>',cols_num,'\n')
```

```{r}
library(e1071)
skewed <- apply(house[cols_num],2, skewness) # 2 indicates column
print("skewed of Original Units")
skewed
```

Since skewness is most likely lower, so we don't need to transformed the features.

## 3. EDA (Exploration Data Analysis) / Data Visualizations

## 3.1 Distribution of all numeric predictors including target `Price` w/o transformation

```{r}
# Histograms for all predictors in house w/o transformation
for (col in cols_num) {
                        hist(house[[col]],
                        main = paste("Original Histogram of", col),
                        xlab = col,
                        col = "skyblue",
                        border = "white")
                                  }
                                  
```

```{r}
library(ggplot2)
#price distribution
ggplot(house, aes(x = Price)) +
geom_histogram(bins=30) +
labs(title = "Distribution of House Prices")+
  theme_minimal()
```

## 3.2 Plotting between all possible two numeric variables 

```{r}
# Load required packages
  library(GGally)
  library(ggplot2)
plot_variable_pairs <- function(df) {
  
  
  # Create pair plot with regression lines
  ggpairs(df,
          lower = list(continuous = wrap("smooth", color = "red")),  # regression line
          diag = list(continuous = wrap("densityDiag", fill = "green")),  # green density plot
          upper = "blank",  
          progress = FALSE
          ) +
          theme_minimal()
}
```

```{r}
plot_variable_pairs(house[cols_num])
```

## 3.3 Scatter Plotting for `Price` by num predictors `Area`, `Bedrooms`, `Bathrooms`, `Floors` using ggplot( Grammer of Graphics plot) 

```{r}
cols_num
```

## By using `For loop`

```{r}
for (col in cols_num){
  # Skip 'Price' only during the loop
  if (col == "Price") next
  # ggplot
  plots <- ggplot(house, aes_string(x = col, y = "Price")) +
               geom_point(color = "green") +
               geom_smooth(method = "lm", color = "red", se = FALSE) +
               labs(title = paste("Price by", col))+
               theme_minimal()
  
  print(plots)
  
}
```

```{r}
#Price vs. Area
g1 <- ggplot(house, aes(x = Area, y = Price)) +
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Price vs. Area", x = "Area", y = "Price") +
            theme_minimal()

g1
```

```{r}
#Price vs. Bedrooms
g2 <- ggplot(house, aes(x = Bedrooms, y = Price)) + 
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Bedrooms vs. Price", x = "Bedrooms", y = "Price") +
            theme_minimal()
g2
```

```{r}
#Price vs. Bathrooms
g3 <- ggplot(house, aes(x = Bathrooms, y = Price)) + 
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Price vs. Bathrooms", x = "Bathrooms", y = "Price")+ 
            theme_minimal()
g3
```

```{r}
#Price vs. Floors
g4 <- ggplot(house, aes(x = Floors, y = Price)) + 
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Price vs. Floors", x = "Floors", y = "Price")+ 
            theme_minimal()
g4
```

```{r}
#Price vs. YearBuiltBin
g5 <- ggplot(house, aes(x = YearBuiltBin, y = Price)) + 
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Price vs. YearBuiltBin", x = "YearBuiltBin", y = "Price")+ 
            theme_minimal()
g5
```

```{r}
#Price vs. Location
g6 <- ggplot(house, aes(x = Location, y = Price)) + 
            geom_point(color = "green") +
            geom_smooth(method = "lm", color = "red", se = FALSE) +
            labs(title = "Price vs. Location", x = "Location", y = "Price")+ 
            theme_minimal()
g6
```

## 3.4 Correlation plot

```{r}
library(corrplot)
cor_matrix <- cor(house[cols_num])
cor_matrix

```

```{r}
corrplot(cor_matrix,
         method="number",
         order="hclust",
         tl.cex=.35,
         title = "Correlation Matrix of numeric transformed Predictor Variables",
         mar = c(0, 0, 2, 0))
```

**Key Insight:** All correlations are extremely weak (close to 0), with the strongest being `Floors-Price` at only 0.056. This suggests these features alone have very little linear relationship with house `Price` in your dataset.

## 3.5 plots between two variables  categorical vs numeric by all possible combinations.

```{r}
plot_categorical_and_continuous_vars <- function(df, categorical_vars, continuous_vars) {
  library(ggplot2)
  library(ggbeeswarm)   # for swarm-like plots
  library(gridExtra)    # to arrange multiple plots

  for (cat_var in categorical_vars) {
    for (cont_var in continuous_vars) {

      # Boxplot
      p1 <- ggplot(df, aes_string(x = cat_var, y = cont_var)) +
        geom_boxplot(fill = "skyblue") +
        ggtitle("Boxplot") +
        theme_minimal()

      # Bar plot (mean value by category)
      p2 <- ggplot(df, aes_string(x = cat_var, y = cont_var)) +
        stat_summary(fun = mean, geom = "bar", fill = "lightgreen") +
        ggtitle("Bar Plot (Mean)") +
        theme_minimal()

      # Scatter plot (jittered to avoid overlap)
      p3 <- ggplot(df, aes_string(x = cat_var, y = cont_var)) +
        geom_jitter(width = 0.2, color = "tomato") +
        ggtitle("Scatter Plot") +
        theme_minimal()

      # Swarm plot (bee swarm)
      p4 <- ggplot(df, aes_string(x = cat_var, y = cont_var)) +
        geom_quasirandom(color = "purple") +
        ggtitle("Swarm Plot") +
        theme_minimal()

      # Arrange the four plots in a grid (like plt.subplot)
      grid.arrange(p1, p2, p3, p4, ncol = 4)
    }
  }
}

```

```{r}
plot_categorical_and_continuous_vars(house,cols_fac,cols_num)
```

```{r}
str(house)
```

## 3.6 Box plot

## By using `For Loop`

```{r}
for (col in cols_fac){
  boxplot <- ggplot(house, aes_string(x = col, y = 'Price')) +
        geom_boxplot(fill = "skyblue") +
        labs(title = paste("Price by", col))+
        theme_minimal()
  
  print(boxplot)
  
}
```

```{r}
# Bar plot between YearBuiltBin vs Price (mean value by category)
library(ggplot2)
 b1 <- ggplot(house, aes_string(x = 'YearBuiltBin', y = 'Price')) +
        geom_boxplot(fill = "skyblue") +
        ggtitle("Box Plot YearBuilt vs Price") +
        theme_minimal()
b1
```

```{r}
# Bar plot between Location vs Price (mean value by category)
library(ggplot2)
 b2 <- ggplot(house, aes_string(x = 'Location', y = 'Price')) +
        geom_boxplot(fill = "skyblue") +
        ggtitle("Box Plot Location vs Price") +
        theme_minimal()
b2
```

```{r}
#Price vs. YearBuiltBin
 b3 <- ggplot(house, aes_string(x = 'Condition', y = 'Price')) +
        geom_boxplot(fill = "skyblue") +
        ggtitle("Box Plot Condition vs Price") +
        theme_minimal()
b3
```

```{r}
 b2 <- ggplot(house, aes_string(x = 'Garage', y = 'Price')) +
        geom_boxplot(fill = "skyblue") +
        ggtitle("Box Plot Garage vs Price ") +
        theme_minimal()
b2
```
